CREATE TABLE cambio (id INT AUTO_INCREMENT, proyecto_id INT NOT NULL, persona_id INT NOT NULL, descripcion VARCHAR(150), fecha DATETIME, INDEX fk_Cambios_Persona2_idx (persona_id), INDEX fk_Cambios_Proyecto2_idx (proyecto_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE equipo (id INT AUTO_INCREMENT, proyecto_id INT NOT NULL, persona_id INT NOT NULL, rol_id INT NOT NULL, nombre VARCHAR(45), activo TINYINT(1), INDEX fk_Equipo_Rol1_idx (rol_id), INDEX fk_Equipo_Persona1_idx (persona_id), INDEX fk_Equipo_Proyecto1_idx (proyecto_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE estado (id INT AUTO_INCREMENT, nombre VARCHAR(45), descripcion MEDIUMTEXT, PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE historial_chat (id INT AUTO_INCREMENT, proyecto_id INT NOT NULL, persona_id INT NOT NULL, mensaje MEDIUMTEXT, created_at DATETIME, activo TINYINT(1), INDEX fk_HistorialChat_Proyecto1_idx (proyecto_id), INDEX fk_HistorialChat_Persona2_idx (persona_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE link (id INT AUTO_INCREMENT, proyecto_id INT NOT NULL, persona_id INT NOT NULL, direccion MEDIUMTEXT NOT NULL, descripcion MEDIUMTEXT, created_at DATETIME, INDEX fk_Link_Proyecto1_idx (proyecto_id), INDEX fk_Link_Persona1_idx (persona_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE persona (id INT AUTO_INCREMENT, idfacebook CHAR(18), nombre VARCHAR(100) NOT NULL, email VARCHAR(45), telefono CHAR(15), activo TINYINT(1), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE product_backlog (id INT AUTO_INCREMENT, proyecto_id INT NOT NULL, persona_id INT NOT NULL, nombre VARCHAR(45) NOT NULL, descripcion MEDIUMTEXT, prioridad TINYINT, duracion SMALLINT, activo TINYINT(1), INDEX fk_ProductBacklog_Proyecto2_idx (proyecto_id), INDEX fk_ProductBacklog_Persona1_idx (persona_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE proyecto (id INT AUTO_INCREMENT, persona_id INT NOT NULL, nombre VARCHAR(45) NOT NULL UNIQUE, descripcion MEDIUMTEXT, comentarios MEDIUMTEXT, created_at DATETIME, updated_at DATETIME, expires_at DATETIME, activo TINYINT(1), INDEX fk_Proyecto_Persona1_idx (persona_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE reunion (id INT AUTO_INCREMENT, proyecto_id INT NOT NULL, persona_id INT NOT NULL, titulo VARCHAR(45), descripcion MEDIUMTEXT, anotaciones MEDIUMTEXT, fecha DATETIME, duracion TINYINT, activo TINYINT(1), INDEX fk_Reunion_Proyecto1_idx (proyecto_id), INDEX fk_Reunion_Persona1_idx (persona_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE rol (id INT AUTO_INCREMENT, nombre VARCHAR(45) NOT NULL, descripcion MEDIUMTEXT, activo TINYINT(1), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE sprint (id INT AUTO_INCREMENT, proyecto_id INT NOT NULL, persona_id INT NOT NULL, estado_id INT NOT NULL, nombre VARCHAR(45), descripcion MEDIUMTEXT, fechainicio DATETIME, fechafin DATETIME, diasdisponibles SMALLINT, INDEX fk_Sprint_Estado1_idx (estado_id), INDEX fk_Sprint_Proyecto1_idx (proyecto_id), INDEX fk_Sprint_Persona1_idx (persona_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE sprint_product_backlog (sprint_id INT, productbacklog_id INT, INDEX fk_SprintProductBacklog_Sprint1_idx (sprint_id), INDEX fk_SprintProductBacklog_ProductBacklog1_idx (productbacklog_id), PRIMARY KEY(sprint_id, productbacklog_id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE tarea (id INT AUTO_INCREMENT, persona_id INT NOT NULL, productbacklog_id INT NOT NULL, estado_id INT NOT NULL, nombre VARCHAR(45), descripcion MEDIUMTEXT, tiempoestimado INT, INDEX fk_Tarea_Estado2_idx (estado_id), INDEX fk_Tarea_Persona1_idx (persona_id), INDEX fk_Tarea_ProductBacklog1_idx (productbacklog_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
ALTER TABLE cambio ADD CONSTRAINT cambio_proyecto_id_proyecto_id FOREIGN KEY (proyecto_id) REFERENCES proyecto(id);
ALTER TABLE cambio ADD CONSTRAINT cambio_persona_id_persona_id FOREIGN KEY (persona_id) REFERENCES persona(id);
ALTER TABLE equipo ADD CONSTRAINT equipo_rol_id_rol_id FOREIGN KEY (rol_id) REFERENCES rol(id);
ALTER TABLE equipo ADD CONSTRAINT equipo_proyecto_id_proyecto_id FOREIGN KEY (proyecto_id) REFERENCES proyecto(id);
ALTER TABLE equipo ADD CONSTRAINT equipo_persona_id_persona_id FOREIGN KEY (persona_id) REFERENCES persona(id);
ALTER TABLE historial_chat ADD CONSTRAINT historial_chat_proyecto_id_proyecto_id FOREIGN KEY (proyecto_id) REFERENCES proyecto(id);
ALTER TABLE historial_chat ADD CONSTRAINT historial_chat_persona_id_persona_id FOREIGN KEY (persona_id) REFERENCES persona(id);
ALTER TABLE link ADD CONSTRAINT link_proyecto_id_proyecto_id FOREIGN KEY (proyecto_id) REFERENCES proyecto(id);
ALTER TABLE link ADD CONSTRAINT link_persona_id_persona_id FOREIGN KEY (persona_id) REFERENCES persona(id);
ALTER TABLE product_backlog ADD CONSTRAINT product_backlog_proyecto_id_proyecto_id FOREIGN KEY (proyecto_id) REFERENCES proyecto(id);
ALTER TABLE product_backlog ADD CONSTRAINT product_backlog_persona_id_persona_id FOREIGN KEY (persona_id) REFERENCES persona(id);
ALTER TABLE proyecto ADD CONSTRAINT proyecto_persona_id_persona_id FOREIGN KEY (persona_id) REFERENCES persona(id);
ALTER TABLE reunion ADD CONSTRAINT reunion_proyecto_id_proyecto_id FOREIGN KEY (proyecto_id) REFERENCES proyecto(id);
ALTER TABLE reunion ADD CONSTRAINT reunion_persona_id_persona_id FOREIGN KEY (persona_id) REFERENCES persona(id);
ALTER TABLE sprint ADD CONSTRAINT sprint_proyecto_id_proyecto_id FOREIGN KEY (proyecto_id) REFERENCES proyecto(id);
ALTER TABLE sprint ADD CONSTRAINT sprint_persona_id_persona_id FOREIGN KEY (persona_id) REFERENCES persona(id);
ALTER TABLE sprint ADD CONSTRAINT sprint_estado_id_estado_id FOREIGN KEY (estado_id) REFERENCES estado(id);
ALTER TABLE sprint_product_backlog ADD CONSTRAINT sprint_product_backlog_sprint_id_sprint_id FOREIGN KEY (sprint_id) REFERENCES sprint(id);
ALTER TABLE sprint_product_backlog ADD CONSTRAINT sprint_product_backlog_productbacklog_id_product_backlog_id FOREIGN KEY (productbacklog_id) REFERENCES product_backlog(id);
ALTER TABLE tarea ADD CONSTRAINT tarea_productbacklog_id_product_backlog_id FOREIGN KEY (productbacklog_id) REFERENCES product_backlog(id);
ALTER TABLE tarea ADD CONSTRAINT tarea_persona_id_persona_id FOREIGN KEY (persona_id) REFERENCES persona(id);
ALTER TABLE tarea ADD CONSTRAINT tarea_estado_id_estado_id FOREIGN KEY (estado_id) REFERENCES estado(id);
