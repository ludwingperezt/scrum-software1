CREATE TABLE Cambios (idcambios INT AUTO_INCREMENT, descripcion VARCHAR(150), fecha DATETIME, proyecto_idproyecto INT NOT NULL, persona_idpersona INT NOT NULL, INDEX fk_Cambios_Proyecto1_idx (proyecto_idproyecto), INDEX fk_Cambios_Persona1_idx (persona_idpersona), PRIMARY KEY(idcambios)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE equipo (idequipo INT AUTO_INCREMENT, idrol INT NOT NULL, idpersona INT NOT NULL, idproyecto INT NOT NULL, nombre VARCHAR(45), activo TINYINT(1), INDEX fk_Equipo_Rol1_idx_idx (idrol), INDEX fk_Equipo_Persona1_idx_idx (idpersona), INDEX fk_Equipo_Proyecto1_idx_idx (idproyecto), PRIMARY KEY(idequipo)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE estado (idestado INT AUTO_INCREMENT, nombre VARCHAR(45), descripcion VARCHAR(45), PRIMARY KEY(idestado)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE historial_chat (idhistorialchat INT AUTO_INCREMENT, idpersona INT NOT NULL, idproyecto INT NOT NULL, mensaje TEXT, fecha DATETIME, activo TINYINT(1), INDEX fk_HistorialChat_Persona1_idx_idx (idpersona), INDEX fk_HistorialChat_Proyecto1_idx_idx (idproyecto), PRIMARY KEY(idhistorialchat)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE link (idlink INT AUTO_INCREMENT, direccion VARCHAR(200), descripcion VARCHAR(200), idproyecto INT NOT NULL, INDEX fk_Link_Proyecto1_idx_idx (idproyecto), PRIMARY KEY(idlink)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE persona (idpersona INT AUTO_INCREMENT, nombre VARCHAR(100) NOT NULL, email VARCHAR(45) NOT NULL UNIQUE, telefono CHAR(15), contrase√±a MEDIUMBLOB NOT NULL, activo TINYINT(1), PRIMARY KEY(idpersona)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE product_backlog (idproductbacklog INT AUTO_INCREMENT, nombre VARCHAR(45), descripcion VARCHAR(100), prioridad TINYINT, duracion SMALLINT, idproyecto INT NOT NULL, idpersona INT NOT NULL, activo TINYINT(1), INDEX fk_ProductBacklog_Proyecto1_idx_idx (idproyecto), INDEX fk_ProductBacklog_Persona1_idx_idx (idpersona), PRIMARY KEY(idproductbacklog)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE proyecto (idproyecto INT AUTO_INCREMENT, idadministrador INT NOT NULL, nombre VARCHAR(45), descripcion VARCHAR(100), comentarios VARCHAR(100), fcreacion DATETIME, fmodificacion DATETIME, ffinalizacion DATETIME, activo TINYINT(1), INDEX fk_Proyecto_Persona1_idx_idx (idadministrador), PRIMARY KEY(idproyecto)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE reunion (idreunion INT AUTO_INCREMENT, titulo VARCHAR(45), descripcion VARCHAR(45), anotaciones VARCHAR(45), fecha DATETIME, duracion TINYINT, idproyecto INT NOT NULL, idpersona INT NOT NULL, activo TINYINT(1), INDEX fk_Reunion_Proyecto1_idx_idx (idproyecto), INDEX fk_Reunion_Persona1_idx_idx (idpersona), PRIMARY KEY(idreunion)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE rol (idrol INT AUTO_INCREMENT, nombre VARCHAR(45) NOT NULL, descripcion VARCHAR(100), activo TINYINT(1), PRIMARY KEY(idrol)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE sprint (idsprint INT AUTO_INCREMENT, nombre VARCHAR(45), descripcion VARCHAR(100), fechainicio DATETIME, fechafin DATETIME, diasdisponibles SMALLINT, idestado INT NOT NULL, INDEX fk_Sprint_Estado1_idx_idx (idestado), PRIMARY KEY(idsprint)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE sprint_product_backlog (idsprint INT, idproductbacklog INT, INDEX fk_Sprint_has_ProductBacklog_ProductBacklog1_idx_idx (idproductbacklog), INDEX fk_Sprint_has_ProductBacklog_Sprint1_idx_idx (idsprint), PRIMARY KEY(idsprint, idproductbacklog)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
CREATE TABLE tarea (idtarea INT AUTO_INCREMENT, nombre VARCHAR(45), descripcion VARCHAR(45), tiempoestimado INT, idproductbacklog INT NOT NULL, idestado INT NOT NULL, idpersona INT NOT NULL, INDEX fk_Tarea_ProductBacklog_idx_idx (idproductbacklog), INDEX fk_Tarea_Estado1_idx_idx (idestado), INDEX fk_Tarea_Persona1_idx_idx (idpersona), PRIMARY KEY(idtarea)) DEFAULT CHARACTER SET latin1 COLLATE latin1_spanish_ci ENGINE = InnoDB;
ALTER TABLE Cambios ADD CONSTRAINT Cambios_proyecto_idproyecto_proyecto_idproyecto FOREIGN KEY (proyecto_idproyecto) REFERENCES proyecto(idproyecto);
ALTER TABLE Cambios ADD CONSTRAINT Cambios_persona_idpersona_persona_idpersona FOREIGN KEY (persona_idpersona) REFERENCES persona(idpersona);
ALTER TABLE equipo ADD CONSTRAINT equipo_idrol_rol_idrol FOREIGN KEY (idrol) REFERENCES rol(idrol);
ALTER TABLE equipo ADD CONSTRAINT equipo_idproyecto_proyecto_idproyecto FOREIGN KEY (idproyecto) REFERENCES proyecto(idproyecto);
ALTER TABLE equipo ADD CONSTRAINT equipo_idpersona_persona_idpersona FOREIGN KEY (idpersona) REFERENCES persona(idpersona);
ALTER TABLE historial_chat ADD CONSTRAINT historial_chat_idproyecto_proyecto_idproyecto FOREIGN KEY (idproyecto) REFERENCES proyecto(idproyecto);
ALTER TABLE historial_chat ADD CONSTRAINT historial_chat_idpersona_persona_idpersona FOREIGN KEY (idpersona) REFERENCES persona(idpersona);
ALTER TABLE link ADD CONSTRAINT link_idproyecto_proyecto_idproyecto FOREIGN KEY (idproyecto) REFERENCES proyecto(idproyecto);
ALTER TABLE product_backlog ADD CONSTRAINT product_backlog_idproyecto_proyecto_idproyecto FOREIGN KEY (idproyecto) REFERENCES proyecto(idproyecto);
ALTER TABLE product_backlog ADD CONSTRAINT product_backlog_idpersona_persona_idpersona FOREIGN KEY (idpersona) REFERENCES persona(idpersona);
ALTER TABLE proyecto ADD CONSTRAINT proyecto_idadministrador_persona_idpersona FOREIGN KEY (idadministrador) REFERENCES persona(idpersona);
ALTER TABLE reunion ADD CONSTRAINT reunion_idproyecto_proyecto_idproyecto FOREIGN KEY (idproyecto) REFERENCES proyecto(idproyecto);
ALTER TABLE reunion ADD CONSTRAINT reunion_idpersona_persona_idpersona FOREIGN KEY (idpersona) REFERENCES persona(idpersona);
ALTER TABLE sprint ADD CONSTRAINT sprint_idestado_estado_idestado FOREIGN KEY (idestado) REFERENCES estado(idestado);
ALTER TABLE sprint_product_backlog ADD CONSTRAINT sprint_product_backlog_idsprint_sprint_idsprint FOREIGN KEY (idsprint) REFERENCES sprint(idsprint);
ALTER TABLE sprint_product_backlog ADD CONSTRAINT sipi FOREIGN KEY (idproductbacklog) REFERENCES product_backlog(idproductbacklog);
ALTER TABLE tarea ADD CONSTRAINT tarea_idproductbacklog_product_backlog_idproductbacklog FOREIGN KEY (idproductbacklog) REFERENCES product_backlog(idproductbacklog);
ALTER TABLE tarea ADD CONSTRAINT tarea_idpersona_persona_idpersona FOREIGN KEY (idpersona) REFERENCES persona(idpersona);
ALTER TABLE tarea ADD CONSTRAINT tarea_idestado_estado_idestado FOREIGN KEY (idestado) REFERENCES estado(idestado);
